name: Trigger Salary CI Workflow

on:
  push:
    branches:
      - master
    paths:
      - 'salary/**'  # Trigger only when files in the salary folder change

jobs:
  trigger:
    runs-on: ubuntu-latest

    steps:
      # Step 1: Checkout the repository
      - name: Checkout Code
        uses: actions/checkout@v3
      
      - name: Trigger Salary Build Workflow
        uses: actions/github-script@v6
        with:
          script: |
            const response = await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'java-ci.yml',  # Path to the CI workflow 
              ref: context.ref  # Use the current branch (e.g., main)
            });
            console.log('Triggered Microservice workflow:', response.status);

      # Step 2: Trigger the second workflow directly via workflow_run event
      # - name: Trigger Salary Build Workflow
      #   uses: peter-evans/workflow-dispatch@v1
      #   with:
      #     workflow: "build.yml"    # The workflow file to trigger in the attendance folder
      #     ref: "refs/heads/master"     # Branch to trigger the workflow for
      #   env:
      #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
